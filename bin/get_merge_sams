#!/usr/bin/env python

import optparse
import sys
import subprocess
import os

# append bin directory to python path
sys.path.append( os.path.realpath(os.path.dirname(sys.argv[0])) )

from read_sort import HadoopRunner

def scan_args(hadoop):
	parser = make_parser()
	opt, args = parser.parse_args()

	if not opt.annotations:
		parser.error("Missing argument --annotations")

	if len(args) != 2:
		parser.error("Incorrect number of arguments")
	else:
		if not hadoop.path_exists(args[0]):
			parser.error("Can't read HDFS input path %s" % args[0])
		elif hadoop.path_exists(args[1]):
			parser.error("HDFS output path %s already exists.  Please remove it first" % args[1])

	return opt, args[0], args[1]


def make_parser():
	parser = optparse.OptionParser(
	  usage="%prog [OPTIONS] --annotations=ANN INPUT OUTPUT",
	  formatter=HelpFormatter()
	  )
	parser.add_option("-a", "--annotations", metavar="FILE",
			help="BWA reference annotations file. For a local file, specify a full URI such as file:///path/to/ref.ann or hdfs:///user/me/ref.ann")
	return parser


def main():
	pass

if __name__ == "__main__":
  main()
